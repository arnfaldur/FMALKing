\documentclass[11pt]{exam}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{framed}
\usepackage{listings}
\usepackage{enumitem}

\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}%

\lhead{T-501-FMAL}
\rhead{Assignment 3}

\begin{document}

\title{Assignment 3}
    \author{{\small T-501-FMAL} \\ \quad \\ Jökull Máni Reynisson ({\tt jokull16@ru.is}) \\  Arnaldur Bjarnason ({\tt arnaldur15@ru.is})}
\date{\today}
\maketitle

\begin{questions}

%% SPURNING

\question Consider the following program with exceptions:
  \begin{lstlisting}
    {
      int x;
      read(x);
      try {
        x = x * 2;
        try {
          if (x == 2) {
            raise E0;
          } else {
            x = x + 4;
          }
            x = x + 1;
          } catch (E0) {
            x = x * 5;
            raise(E1);
            x = x + 42175;
          }
          x = x * 7;
        } catch (E1) {
          x = x + 10;
        }
        write(x);
      }
  \end{lstlisting}
What will be printed if (i) 0 is read. (ii) 1 is read?

Explain.

        \begin{enumerate}[label=(\roman*)]
            \item 0 is read
                \begin{framed}
                    If {\tt x} is zero, then we enter the first try block and set {\tt x} to $2\times 0 = 0$ and thus as we enter the second try block we do not raise {\tt E0} and add 4 and then an additional 1 to {\tt x} and it is now 5. We then leave the inner try block, go past the catch block and multiply ${\tt x} = 5 \times 7 = 35$.
                    We then finally break out of the outer try and {\tt write(x)} and output 35.
                \end{framed}

            \item 1 is read
                \begin{framed}
                    If {\tt x} is one however, then since we set ${\tt x} = 1 \times 2 = 2$ as we enter the outer try and thus will raise {\tt E0} in the inner try and control will jump to the inner catch block, setting ${\tt x} = 2 * 5 = 10$. Following this we have an unconditional raise of {\tt E1} (meaning that the line {\tt x = x + 42175;} is unreachable) and control jumps to the outer catch block finally setting ${\tt x} = 10 + 10 = 20$ before breaking to the outermost block and {\tt write(x)} outputting 20.
                \end{framed}
        \end{enumerate}



%% SPURNING

	\question Sample question

        \begin{enumerate}[label=(\alph*)]
        \item Suppose {\tt int} is a subtype of {\tt float} in a language with subtyping
          and implicit conversions but no polymorphism. \\
          (Suppose also that {\tt int} has no proper subtypes and {\tt float} has no proper supertypes.)\\
          If the following program is well-typed. What is the type of the function {\tt f}?
\begin{lstlisting}
  float x, y;
  ...
  if (f(x) mod 3 == 2) then y = f(5);
\end{lstlisting}
          {\tt mod} only accepts arguments of type {\tt int}.\\
          Explain.
        \item Modify the program so it works when an explicit conversion {\tt i2f} is required to cast an {\tt int} value into a {\tt float} value.

        \end{enumerate}

	\begin{framed}


	\end{framed}

        \begin{enumerate}[label=(\alph*)]
            \item 0 is read
                \begin{framed}
                    The function {\tt f} has the type {\tt float $\to$ int}.

                    We know that {\tt f} returns {\tt int} because {\tt mod} accepts arguments only of that type. We can also see that {\tt f} takes in both a float and an integer, but since in this language {\tt int} is a subtype of {\tt float} and is thus implicitly converted we can safely assume that the input parameter of {\tt f} is a {\tt float}.
                \end{framed}

            \item 1 is read
                \begin{framed}
                \end{framed}
        \end{enumerate}

%% SPURNING

      \question Given the following function definition in a language
        with polymorphism and inferred types but no subtyping.\\
        Find the most general type of the function {\tt h} in the following program.
\begin{lstlisting}
  h(f, g, x) {
    if (x == 1) {
      return "hello";
    } else {
      return g(f(x));
    }
  }
\end{lstlisting}
        Assume that $1$ is of type {\tt int}. {\tt "hello"} is of type {\tt string},
        and comparison for equality is only available for two values of the same type. \\
        Explain.

	\begin{framed}


	\end{framed}

%% SPURNING

	\question Consider a programming language with pointer types and an explicit dereferencing operator. The programmer deallocates memory and {\emph there is no safety mechanism implemented to detect the emergence of dangling references}. Suppose that assigning to a pointer the value {\tt null} does not free the memory it pointed to, it merely sets the pointer value to {\tt null}, i.e. the pointer now does point anywhere. {\tt free} frees the memory pointed to by a given pointer without clearing it; it also leaves the pointer pointing there.

      \begin{enumerate}[label=(\roman*)]
      \item What does the following program print? Explain.
\begin{lstlisting}
int *p, *q;
p = new int;
q = p;
*q = 5;
write(*p);
p = null;
write(*q);
\end{lstlisting}

            \item What will the following program print? Explain.
\begin{lstlisting}
int *p, *q;
p = new int;
q = p;
*q = 5;
free(p);
write(*p);
*q = *p + 1;
write(*p);
\end{lstlisting}

            \item What will the following program likely print? (Assume that free heap memory is tracked with a free list, so that the memory freed last will be taken into use anew first). Explain.
\begin{lstlisting}
int *p, *q, *r, *s;
p = new int;
q = p;
*q = 5;
free(p);
p = null;
free(q);
r = new int;
*r = 17;
wirite(*q);
s = new int;
write(*s);
\end{lstlisting}
        \end{enumerate}

	\begin{framed}


	\end{framed}

        \begin{enumerate}[label=(\roman*)]
            \item 1 is read
                \begin{framed}
                \end{framed}
            \item 1 is read
                \begin{framed}
                \end{framed}
            \item 1 is read
                \begin{framed}
                \end{framed}
        \end{enumerate}

%% SPURNING

	\question Sample question

	%%\begin{parts}
	%%\end{pars}

	\quad

	Question instructions

	\begin{framed}


	\end{framed}

\end{questions}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
